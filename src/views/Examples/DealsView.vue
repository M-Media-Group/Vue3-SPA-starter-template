<script setup lang="ts">
// @ts-nocheck
import { computed, ref, shallowRef } from "vue";
import { debounce } from "@/helpers/debounce";
import DropdownSelect from "@/components/DropdownSelect.vue";
import BaseForm from "@/forms/BaseForm.vue";
import CardElement from "@/components/CardElement.vue";
import PaginationNav from "@/components/PaginationNav.vue";
import TabNav from "@/components/TabNav.vue";
import BaseModal from "@/components/modals/BaseModal.vue";

const mappedValuesToFoods = {
  5: ["Coffee", "Snack", "Drink", "Tea"],
  10: ["Entree", "Dessert", "Main Course"],
  20: [
    "Entree + Dessert",
    "Main Course + Dessert",
    "Entree + Main Course",
    "Discount",
  ],
  30: [
    "Entree + Main Course + Dessert",
    "Full Meal",
    "All You Can Eat",
    "Dinner",
    "Large Discount",
  ],
};

const currentGeoResults = shallowRef([]);
const isLoadingGeoResults = ref(false);
const isOpen = ref(false);

/** A ref to if we should show a "still loading" message if the loading is taking long */
const showLoadingMessage = ref(false);

/** This function will set showLoadingMessage to true in 2 seconds unless it is called a second time */
const showLoadingMessageTimeout = () => {
  setTimeout(() => {
    if (isLoadingOverpassResults.value) {
      showLoadingMessage.value = true;
    }
  }, 3500);
};

const getGeolocationData = async (query: string) => {
  if (isLoadingGeoResults.value) {
    return;
  }
  isLoadingGeoResults.value = true;

  const response = await fetch(
    `https://nominatim.openstreetmap.org/search.php?featureType=settlement&q=${query}&format=jsonv2`,
    {
      method: "GET",
      headers: {
        "Content-Type": "application/json",
        Accept: "application/json",
      },
    }
  ).catch((error) => {
    isLoadingGeoResults.value = false;
    console.error("Error:", error);
  });

  const json = await response.json();

  isLoadingGeoResults.value = false;

  if (json.error) {
    return;
  }

  currentGeoResults.value = json;

  return json;
};

const selectedGeoResult = ref({} as any);
const selectedGeoResultId = ref([] as string[]);
const geoSearchTerm = ref("");

const selectResult = (result: string[]) => {
  selectedGeoResultId.value = result;
  // Close the dropdown
  isOpen.value = false;
  // Set the selected result

  selectedGeoResult.value = currentGeoResults.value.find(
    // @ts-ignore
    (item) => item.place_id == result
  );

  // Clear the currentOverpassResults
  currentOverpassResults.value = [];

  if (!selectedGeoResult.value) {
    return;
  }

  getOverpassData(
    `${selectedGeoResult.value.boundingbox[0]},${selectedGeoResult.value.boundingbox[2]},${selectedGeoResult.value.boundingbox[1]},${selectedGeoResult.value.boundingbox[3]}`,
    categories
  );
};

const categories = [
  "restaurant",
  "cafe",
  "bar",
  "pub",
  "planetarium",
  // "nightclub",
  // "music_venue",
  "cinema",
];

const optionsToShow = computed(() => {
  return currentGeoResults.value?.map((item) => {
    return {
      // @ts-ignore
      id: item.place_id,
      // @ts-ignore
      render: item.display_name,
      raw: item,
    };
  });
});

// We need to make sure that the optionsToShow also includes the selectedGeoResult
const optionsToShowWithSelected = computed(() => {
  if (
    selectedGeoResult.value?.place_id &&
    // And doesnt already exist in the optionsToShow
    !optionsToShow.value.find(
      (item) => item.id == selectedGeoResult.value.place_id
    )
  ) {
    // Use a set to remove duplicates
    const allData = [
      {
        id: selectedGeoResult.value.place_id,
        render: selectedGeoResult.value.display_name,
        raw: selectedGeoResult.value,
      },
      ...optionsToShow.value,
    ];

    return Array.from(new Set(allData));
  }
  return optionsToShow.value;
});

const debounceGetGeolocationData = debounce(getGeolocationData);

/**
 *
 * Stuff for Overpass API
 *
 *
 */
const currentOverpassResults = shallowRef([]);
const isLoadingOverpassResults = ref(false);

const currentResultsPage = ref(1);

// Convert [amenity=${amenity}] to something that can accept many amenities
function generateOverpassRequest(amenities, bbox) {
  const baseUrl = "https://overpass-api.de/api/interpreter?data=";
  let query = "[out:json][timeout:25];(";

  // Construct query for each amenity
  const amenityQueries = amenities.map((amenity) => {
    return `nwr["amenity"="${amenity}"](${bbox});`;
  });

  // Join all the amenity queries together
  query += amenityQueries.join("");

  query += ");out geom;";

  const encodedQuery = encodeURIComponent(query);
  return baseUrl + encodedQuery;
}

const getOverpassData = async (bbox: string, amenities: string[]) => {
  if (isLoadingOverpassResults.value) {
    return;
  }
  isLoadingOverpassResults.value = true;

  const url = generateOverpassRequest(amenities, bbox);

  showLoadingMessageTimeout();

  const response = await fetch(
    url,

    {
      method: "GET",
      headers: {
        "Content-Type": "application/json",
        Accept: "application/json",
      },
    }
  );

  const json = await response.json();

  showLoadingMessage.value = false;

  if (json.error) {
    isLoadingOverpassResults.value = false;
    return;
  }
  currentOverpassResults.value = json.elements;
  isLoadingOverpassResults.value = false;

  currentResultsPage.value = 1;

  return json;
};

const selectedCategory = ref(["all"]);

const usableResults = computed(() => {
  return currentOverpassResults.value.filter(
    (item) =>
      item.tags?.name &&
      (item.tags?.description ||
        item.tags?.opening_hours ||
        item.tags?.cuisine) &&
      // And is NOT a brand
      !item.tags?.brand &&
      // And has at least an email or a website
      (item.tags?.contact_email || item.tags?.email || item.tags?.website) &&
      // If the category is all, then we show all
      (selectedCategory.value[0] === "all" ||
        // Otherwise, we show only the selected category
        item.tags?.amenity === selectedCategory.value[0])
  );
});

const totalEarnable = computed(() => {
  // Count the amount of total tags across all currentOverpassResults
  const value = usableResults.value.reduce((acc, item) => {
    return acc + Object.keys(item.tags).length;
  }, 0);

  // Format the value into money
  return Intl.NumberFormat("en-IE", {
    style: "currency",
    currency: "EUR",
    // 0 decimal places
    minimumFractionDigits: 0,
  }).format(value);
});

const filteredOverpassResults = computed(() => {
  const data = usableResults.value;
  return (
    data
      // Order by the count of tags
      .sort((a, b) => {
        return Object.keys(b.tags).length - Object.keys(a.tags).length;
      })
      // Slice based on the results page (15 per page)
      .slice((currentResultsPage.value - 1) * 15, currentResultsPage.value * 15)
  );
});

const scrollUp = () => {
  // Trigger loading - we give a fake impression to the user that work is being done
  isLoadingOverpassResults.value = true;
  window.scrollTo({ top: 0, behavior: "smooth" });
  setTimeout(() => {
    isLoadingOverpassResults.value = false;
  }, 2000);
};

/** Randomly select a string from the mapped value. If the value provided is 3, it should match up to the nearest one which is 5 in this casle */
const randomFood = (value: number) => {
  const keys = Object.keys(mappedValuesToFoods);
  const closest = keys.reduce((prev, curr) =>
    Math.abs(curr - value) < Math.abs(prev - value) ? curr : prev
  );
  const randomIndex = Math.floor(
    Math.random() * mappedValuesToFoods[closest].length
  );
  return mappedValuesToFoods[closest][randomIndex];
};

const categoriesToShow = computed(() => {
  return ["all", ...categories];
});

const resetCurrentPage = () => {
  currentResultsPage.value = 1;
};
</script>

<template>
  <main>
    <section v-if="!selectedGeoResult?.place_id">
      <svg
        width="361"
        height="76"
        viewBox="0 0 361 76"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        style="margin-bottom: 2rem"
      >
        <path
          d="M6.816 42.592C6.816 40.352 7.072 38.16 7.584 36.016C8.128 33.84 8.88 31.792 9.84 29.872C10.8 27.92 11.936 26.144 13.248 24.544C14.592 22.912 16.048 21.504 17.616 20.32C19.216 19.136 20.912 18.224 22.704 17.584C24.496 16.912 26.336 16.576 28.224 16.576C30.432 16.576 32.144 17.04 33.36 17.968C34.608 18.896 35.232 20.192 35.232 21.856C35.232 22.496 35.136 23.152 34.944 23.824C34.784 24.496 34.528 25.168 34.176 25.84C33.856 26.48 33.472 27.104 33.024 27.712C32.576 28.32 32.08 28.848 31.536 29.296C30.704 29.168 29.984 28.8 29.376 28.192C28.768 27.552 28.384 26.816 28.224 25.984C29.344 25.056 30.224 24.096 30.864 23.104C31.536 22.08 31.872 21.152 31.872 20.32C31.872 18.912 30.992 18.208 29.232 18.208C28.496 18.208 27.728 18.368 26.928 18.688C26.16 18.976 25.376 19.392 24.576 19.936C23.776 20.48 22.992 21.136 22.224 21.904C21.488 22.672 20.8 23.52 20.16 24.448C15.712 30.848 13.488 37.392 13.488 44.08C13.488 46.448 13.856 48.352 14.592 49.792C15.328 51.232 16.304 52.08 17.52 52.336C18.896 52.016 20.64 51.136 22.752 49.696C24.864 48.256 27.168 46.384 29.664 44.08C29.984 44.4 30.176 44.736 30.24 45.088C29.312 46.304 28.352 47.472 27.36 48.592C26.368 49.712 25.376 50.736 24.384 51.664C23.424 52.592 22.464 53.408 21.504 54.112C20.576 54.816 19.712 55.36 18.912 55.744C14.944 55.68 11.936 54.544 9.888 52.336C7.84 50.128 6.816 46.88 6.816 42.592ZM39.0544 53.68C37.2304 53.488 35.7744 52.688 34.6864 51.28C33.5984 49.872 33.0544 48.08 33.0544 45.904C33.0544 44.624 33.2464 43.296 33.6304 41.92C34.0144 40.544 34.5584 39.216 35.2624 37.936C35.9664 36.624 36.7984 35.392 37.7584 34.24C38.7184 33.088 39.7584 32.096 40.8784 31.264C42.6384 29.952 44.2864 29.296 45.8224 29.296C46.8464 29.84 47.8544 30.976 48.8464 32.704C49.0064 32.704 49.1504 32.704 49.2784 32.704C49.4064 32.672 49.5504 32.656 49.7104 32.656C51.4064 32.656 52.2544 34.16 52.2544 37.168C52.2544 39.184 51.9184 41.104 51.2464 42.928C50.6064 44.72 49.6944 46.352 48.5104 47.824C47.3584 49.296 45.9664 50.544 44.3344 51.568C42.7344 52.56 40.9744 53.264 39.0544 53.68ZM41.5024 38.56C40.9584 39.296 40.4464 40.096 39.9664 40.96C39.4864 41.824 39.0704 42.704 38.7184 43.6C38.3664 44.464 38.0944 45.312 37.9024 46.144C37.7104 46.944 37.6144 47.664 37.6144 48.304C37.6144 49.072 37.7424 49.808 37.9984 50.512C38.2544 51.216 38.5424 51.616 38.8624 51.712C40.3024 51.392 41.6144 50.8 42.7984 49.936C44.0144 49.04 45.0544 47.936 45.9184 46.624C46.8144 45.312 47.5024 43.824 47.9824 42.16C48.4944 40.496 48.7504 38.72 48.7504 36.832C48.7504 36 48.7024 35.344 48.6064 34.864C48.5104 34.384 48.3504 33.968 48.1264 33.616C46.7184 34.032 45.4544 34.704 44.3344 35.632C43.2464 36.56 42.3024 37.536 41.5024 38.56ZM62.3539 28.72C63.1859 28.976 63.9699 29.552 64.7059 30.448C65.4419 31.312 65.9859 32.272 66.3379 33.328C65.9859 34.192 65.4419 35.232 64.7059 36.448C63.9699 37.664 63.2339 38.912 62.4979 40.192C61.7619 41.44 61.0899 42.64 60.4819 43.792C59.9059 44.912 59.5699 45.84 59.4739 46.576C59.9859 46.032 60.5459 45.408 61.1539 44.704C61.7939 43.968 62.4019 43.248 62.9779 42.544C63.5859 41.808 64.1459 41.152 64.6579 40.576C65.1699 39.968 65.5699 39.52 65.8579 39.232C66.4659 38.592 67.1859 37.856 68.0179 37.024C68.8499 36.16 69.7139 35.36 70.6099 34.624C71.5379 33.856 72.4659 33.216 73.3939 32.704C74.3219 32.16 75.1699 31.888 75.9379 31.888C76.7699 31.888 77.4579 32.176 78.0019 32.752C78.5779 33.296 79.0259 33.872 79.3459 34.48C79.3459 34.544 79.2179 34.64 78.9619 34.768C78.7379 34.864 78.4019 35.168 77.9539 35.68C77.5059 36.256 76.9939 37.056 76.4179 38.08C75.8739 39.072 75.3299 40.16 74.7859 41.344C74.2739 42.496 73.8419 43.68 73.4899 44.896C73.1379 46.112 72.9619 47.216 72.9619 48.208C72.9619 49.008 73.0579 49.52 73.2499 49.744C73.4739 49.968 73.7779 50.08 74.1619 50.08C74.5139 50.08 74.8819 50 75.2659 49.84C75.6499 49.68 75.9539 49.6 76.1779 49.6C76.3059 49.664 76.4019 49.808 76.4659 50.032C76.5619 50.224 76.6099 50.4 76.6099 50.56C76.3539 50.784 76.0499 51.008 75.6979 51.232C75.3459 51.456 74.9779 51.664 74.5939 51.856C74.2099 52.048 73.8259 52.208 73.4419 52.336C73.0899 52.464 72.7699 52.528 72.4819 52.528C71.5539 52.528 70.7859 52.384 70.1779 52.096C69.6019 51.84 69.1379 51.488 68.7859 51.04C68.4659 50.592 68.2419 50.064 68.1139 49.456C67.9859 48.816 67.9219 48.144 67.9219 47.44C67.9219 47.056 67.9539 46.624 68.0179 46.144C68.0819 45.664 68.2099 45.104 68.4019 44.464C68.5939 43.792 68.8659 43.008 69.2179 42.112C69.5699 41.184 70.0179 40.08 70.5619 38.8C70.4979 38.8 70.0659 39.024 69.2659 39.472C68.4659 39.92 67.6019 40.608 66.6739 41.536C65.1699 42.976 63.8099 44.4 62.5939 45.808C61.4099 47.216 60.1939 48.784 58.9459 50.512C58.2419 51.504 57.6179 52.336 57.0739 53.008C56.5619 53.712 56.1139 54.176 55.7299 54.4C55.0579 54.016 54.5619 53.472 54.2419 52.768C53.9219 52.096 53.6819 51.392 53.5219 50.656C53.5219 50.048 53.6019 49.28 53.7619 48.352C53.9539 47.424 54.1939 46.4 54.4819 45.28C54.8019 44.128 55.1859 42.928 55.6339 41.68C56.0819 40.432 56.5779 39.184 57.1219 37.936C58.3379 35.12 59.4419 32.912 60.4339 31.312C61.4579 29.712 62.0979 28.848 62.3539 28.72ZM83.3318 33.616C83.1718 33.424 83.0278 33.024 82.8997 32.416C82.7718 31.776 82.7078 31.232 82.7078 30.784C83.5398 30.848 84.3398 30.912 85.1078 30.976C85.8758 31.008 86.5798 31.04 87.2198 31.072C87.6998 30.112 88.2118 29.168 88.7558 28.24C89.3318 27.28 89.8758 26.416 90.3878 25.648C90.9318 24.848 91.4278 24.176 91.8758 23.632C92.3558 23.088 92.7238 22.736 92.9798 22.576C93.2998 22.576 93.6998 22.64 94.1798 22.768C94.6918 22.864 95.2038 23.008 95.7158 23.2C96.2278 23.36 96.6918 23.536 97.1078 23.728C97.5238 23.92 97.8118 24.112 97.9718 24.304C97.0118 25.52 96.1798 26.656 95.4758 27.712C94.8038 28.736 94.0678 29.92 93.2678 31.264C93.9078 31.264 94.5478 31.248 95.1878 31.216C95.8598 31.184 96.5318 31.136 97.2038 31.072C97.3638 31.232 97.4918 31.44 97.5878 31.696C97.6838 31.92 97.7318 32.16 97.7318 32.416C96.1638 32.992 94.2598 33.312 92.0198 33.376C91.2198 34.912 90.4998 36.448 89.8598 37.984C89.2518 39.488 88.7238 40.944 88.2758 42.352C87.8598 43.76 87.5238 45.088 87.2678 46.336C87.0438 47.584 86.9318 48.704 86.9318 49.696C86.9318 51.104 87.4598 51.888 88.5157 52.048C89.4757 51.92 90.3878 51.68 91.2518 51.328C92.1158 50.976 92.8838 50.528 93.5558 49.984C93.7478 50.272 93.8598 50.512 93.8918 50.704C93.6998 50.992 93.3638 51.328 92.8838 51.712C92.4358 52.096 91.9398 52.464 91.3958 52.816C90.8518 53.2 90.3238 53.52 89.8118 53.776C89.2998 54.032 88.9158 54.176 88.6598 54.208C87.8598 54.176 87.0598 54 86.2598 53.68C85.4598 53.36 84.7238 52.96 84.0518 52.48C83.4118 52 82.8838 51.472 82.4678 50.896C82.0518 50.288 81.8438 49.696 81.8438 49.12C81.8438 48.352 81.9398 47.392 82.1318 46.24C82.3558 45.056 82.6598 43.776 83.0438 42.4C83.4278 41.024 83.8758 39.584 84.3878 38.08C84.8998 36.576 85.4598 35.088 86.0678 33.616H83.3318ZM114.559 32.128C114.431 34.112 114.079 35.824 113.503 37.264C112.927 38.672 112.095 39.92 111.007 41.008C109.951 42.064 108.655 43.024 107.119 43.888C105.583 44.752 103.791 45.584 101.743 46.384C101.743 46.576 101.727 46.784 101.695 47.008C101.695 47.2 101.695 47.408 101.695 47.632C101.695 48.048 101.727 48.48 101.791 48.928C101.855 49.376 101.967 49.792 102.127 50.176C102.287 50.56 102.511 50.88 102.799 51.136C103.087 51.36 103.455 51.472 103.903 51.472C104.767 51.472 105.615 51.28 106.447 50.896C107.279 50.512 108.063 50.048 108.799 49.504C109.567 48.928 110.271 48.32 110.911 47.68C111.583 47.008 112.175 46.4 112.687 45.856C113.007 46.144 113.279 46.416 113.503 46.672C112.063 48.592 110.479 50.192 108.751 51.472C107.055 52.72 105.439 53.52 103.903 53.872C101.695 53.616 99.9668 52.816 98.7188 51.472C97.5028 50.096 96.8948 48.448 96.8948 46.528C96.8948 45.216 97.0708 43.888 97.4228 42.544C97.8068 41.168 98.3188 39.856 98.9588 38.608C99.6308 37.328 100.399 36.128 101.263 35.008C102.159 33.888 103.103 32.912 104.095 32.08C105.119 31.248 106.159 30.592 107.215 30.112C108.303 29.632 109.375 29.392 110.431 29.392C111.903 29.584 113.279 30.496 114.559 32.128ZM111.247 33.712C110.383 33.84 109.487 34.192 108.559 34.768C107.631 35.344 106.751 36.112 105.919 37.072C105.119 38.032 104.383 39.152 103.711 40.432C103.039 41.712 102.511 43.088 102.127 44.56C104.687 43.28 106.815 41.712 108.511 39.856C110.207 37.968 111.119 35.92 111.247 33.712ZM124.557 28.72C125.389 28.976 126.173 29.552 126.909 30.448C127.645 31.312 128.189 32.272 128.541 33.328C128.189 34.192 127.645 35.232 126.909 36.448C126.173 37.664 125.437 38.912 124.701 40.192C123.965 41.44 123.293 42.64 122.685 43.792C122.109 44.912 121.773 45.84 121.677 46.576C122.189 46.032 122.749 45.408 123.357 44.704C123.997 43.968 124.605 43.248 125.181 42.544C125.789 41.808 126.349 41.152 126.861 40.576C127.373 39.968 127.773 39.52 128.061 39.232C128.669 38.592 129.389 37.856 130.221 37.024C131.053 36.16 131.917 35.36 132.813 34.624C133.741 33.856 134.669 33.216 135.597 32.704C136.525 32.16 137.373 31.888 138.141 31.888C138.973 31.888 139.661 32.176 140.205 32.752C140.781 33.296 141.229 33.872 141.549 34.48C141.549 34.544 141.421 34.64 141.165 34.768C140.941 34.864 140.605 35.168 140.157 35.68C139.709 36.256 139.197 37.056 138.621 38.08C138.077 39.072 137.533 40.16 136.989 41.344C136.477 42.496 136.045 43.68 135.693 44.896C135.341 46.112 135.165 47.216 135.165 48.208C135.165 49.008 135.261 49.52 135.453 49.744C135.677 49.968 135.981 50.08 136.365 50.08C136.717 50.08 137.085 50 137.469 49.84C137.853 49.68 138.157 49.6 138.381 49.6C138.509 49.664 138.605 49.808 138.669 50.032C138.765 50.224 138.813 50.4 138.813 50.56C138.557 50.784 138.253 51.008 137.901 51.232C137.549 51.456 137.181 51.664 136.797 51.856C136.413 52.048 136.029 52.208 135.645 52.336C135.293 52.464 134.973 52.528 134.685 52.528C133.757 52.528 132.989 52.384 132.381 52.096C131.805 51.84 131.341 51.488 130.989 51.04C130.669 50.592 130.445 50.064 130.317 49.456C130.189 48.816 130.125 48.144 130.125 47.44C130.125 47.056 130.157 46.624 130.221 46.144C130.285 45.664 130.413 45.104 130.605 44.464C130.797 43.792 131.069 43.008 131.421 42.112C131.773 41.184 132.221 40.08 132.765 38.8C132.701 38.8 132.269 39.024 131.469 39.472C130.669 39.92 129.805 40.608 128.877 41.536C127.373 42.976 126.013 44.4 124.797 45.808C123.613 47.216 122.397 48.784 121.149 50.512C120.445 51.504 119.821 52.336 119.277 53.008C118.765 53.712 118.317 54.176 117.933 54.4C117.261 54.016 116.765 53.472 116.445 52.768C116.125 52.096 115.885 51.392 115.725 50.656C115.725 50.048 115.805 49.28 115.965 48.352C116.157 47.424 116.397 46.4 116.685 45.28C117.005 44.128 117.389 42.928 117.837 41.68C118.285 40.432 118.781 39.184 119.325 37.936C120.541 35.12 121.645 32.912 122.637 31.312C123.661 29.712 124.301 28.848 124.557 28.72ZM145.535 33.616C145.375 33.424 145.231 33.024 145.103 32.416C144.975 31.776 144.911 31.232 144.911 30.784C145.743 30.848 146.543 30.912 147.311 30.976C148.079 31.008 148.783 31.04 149.423 31.072C149.903 30.112 150.415 29.168 150.959 28.24C151.535 27.28 152.079 26.416 152.591 25.648C153.135 24.848 153.631 24.176 154.079 23.632C154.559 23.088 154.927 22.736 155.183 22.576C155.503 22.576 155.903 22.64 156.383 22.768C156.895 22.864 157.407 23.008 157.919 23.2C158.431 23.36 158.895 23.536 159.311 23.728C159.727 23.92 160.015 24.112 160.175 24.304C159.215 25.52 158.383 26.656 157.679 27.712C157.007 28.736 156.271 29.92 155.471 31.264C156.111 31.264 156.751 31.248 157.391 31.216C158.063 31.184 158.735 31.136 159.407 31.072C159.567 31.232 159.695 31.44 159.791 31.696C159.887 31.92 159.935 32.16 159.935 32.416C158.367 32.992 156.463 33.312 154.223 33.376C153.423 34.912 152.703 36.448 152.063 37.984C151.455 39.488 150.927 40.944 150.479 42.352C150.063 43.76 149.727 45.088 149.471 46.336C149.247 47.584 149.135 48.704 149.135 49.696C149.135 51.104 149.663 51.888 150.719 52.048C151.679 51.92 152.591 51.68 153.455 51.328C154.319 50.976 155.087 50.528 155.759 49.984C155.951 50.272 156.063 50.512 156.095 50.704C155.903 50.992 155.567 51.328 155.087 51.712C154.639 52.096 154.143 52.464 153.599 52.816C153.055 53.2 152.527 53.52 152.015 53.776C151.503 54.032 151.119 54.176 150.863 54.208C150.063 54.176 149.263 54 148.463 53.68C147.663 53.36 146.927 52.96 146.255 52.48C145.615 52 145.087 51.472 144.671 50.896C144.255 50.288 144.047 49.696 144.047 49.12C144.047 48.352 144.143 47.392 144.335 46.24C144.559 45.056 144.863 43.776 145.247 42.4C145.631 41.024 146.079 39.584 146.591 38.08C147.103 36.576 147.663 35.088 148.271 33.616H145.535ZM162.218 65.872C161.418 65.552 160.938 64.944 160.778 64.048C160.65 63.184 160.106 62.48 159.146 61.936C159.402 60.304 159.69 58.656 160.01 56.992C160.33 55.328 160.73 53.44 161.21 51.328C161.722 49.184 162.346 46.704 163.082 43.888C163.85 41.04 164.81 37.6 165.962 33.568C164.906 33.568 164.074 33.584 163.466 33.616C162.858 33.648 162.266 33.712 161.69 33.808C161.562 33.68 161.45 33.504 161.354 33.28C161.29 33.056 161.258 32.848 161.258 32.656C161.578 32.528 162.234 32.368 163.226 32.176C164.218 31.952 165.306 31.76 166.49 31.6C167.258 29.168 168.138 26.992 169.13 25.072C170.122 23.12 171.194 21.456 172.346 20.08C173.498 18.704 174.714 17.648 175.994 16.912C177.274 16.176 178.57 15.808 179.882 15.808C180.266 15.808 180.634 15.84 180.986 15.904C181.338 15.936 181.61 15.952 181.802 15.952C182.09 15.728 182.474 15.536 182.954 15.376C183.434 15.184 183.85 15.088 184.202 15.088C184.586 15.088 185.082 15.296 185.69 15.712C185.434 16.16 185.162 16.768 184.874 17.536C184.586 18.304 184.346 19.056 184.154 19.792C183.354 22.16 182.506 23.696 181.61 24.4C181.258 24.4 181.066 23.936 181.034 23.008C181.002 22.336 180.906 21.68 180.746 21.04C180.618 20.752 180.522 20.496 180.458 20.272C180.426 20.048 180.41 19.76 180.41 19.408C180.41 19.216 180.426 18.992 180.458 18.736C180.49 18.448 180.554 17.984 180.65 17.344C180.106 17.344 179.498 17.68 178.826 18.352C178.186 19.024 177.498 19.984 176.762 21.232C176.058 22.448 175.338 23.904 174.602 25.6C173.866 27.296 173.162 29.168 172.49 31.216L176.522 31.072C176.682 31.232 176.81 31.6 176.906 32.176C177.034 32.72 177.114 33.296 177.146 33.904L171.866 33.616C170.65 37.232 169.514 40.688 168.458 43.984C167.402 47.28 166.458 50.32 165.626 53.104C164.794 55.888 164.074 58.368 163.466 60.544C162.89 62.752 162.474 64.528 162.218 65.872ZM189.04 50.944C188.432 50.432 188.016 49.792 187.792 49.024C187.6 48.256 187.504 47.6 187.504 47.056C187.504 46.384 187.584 45.808 187.744 45.328C187.616 45.328 187.328 45.584 186.88 46.096C186.432 46.608 185.936 47.216 185.392 47.92C184.88 48.624 184.368 49.312 183.856 49.984C183.344 50.656 182.96 51.152 182.704 51.472C182.288 51.92 181.888 52.272 181.504 52.528C181.152 52.784 180.864 52.928 180.64 52.96C180.128 52.928 179.584 52.816 179.008 52.624C178.464 52.464 177.936 52.224 177.424 51.904C176.944 51.584 176.512 51.2 176.128 50.752C175.776 50.304 175.536 49.792 175.408 49.216C175.408 48.32 175.424 47.584 175.456 47.008C175.52 46.432 175.632 45.808 175.792 45.136C176.08 43.92 176.496 42.544 177.04 41.008C177.616 39.472 178.272 37.968 179.008 36.496C179.744 34.992 180.56 33.6 181.456 32.32C182.384 31.008 183.36 29.984 184.384 29.248C184.672 29.248 185.008 29.28 185.392 29.344C185.776 29.376 186.16 29.456 186.544 29.584C186.96 29.712 187.344 29.872 187.696 30.064C188.08 30.224 188.4 30.448 188.656 30.736C188.368 31.056 187.632 32.128 186.448 33.952C185.296 35.776 184 38.4 182.56 41.824C182.4 42.176 182.208 42.688 181.984 43.36C181.76 44.032 181.536 44.736 181.312 45.472C181.088 46.208 180.896 46.928 180.736 47.632C180.608 48.336 180.544 48.896 180.544 49.312C180.544 49.568 180.576 49.76 180.64 49.888C180.736 50.016 180.816 50.112 180.88 50.176C181.36 49.984 181.968 49.456 182.704 48.592C183.44 47.728 184.464 46.4 185.776 44.608C186.096 44.16 186.464 43.648 186.88 43.072C187.328 42.496 187.776 41.888 188.224 41.248C188.672 40.576 189.088 39.888 189.472 39.184C189.888 38.48 190.224 37.776 190.48 37.072C190.608 36.688 190.768 36.24 190.96 35.728C191.184 35.184 191.44 34.624 191.728 34.048C192.048 33.472 192.4 32.896 192.784 32.32C193.2 31.712 193.68 31.152 194.224 30.64C194.64 30.64 195.088 30.688 195.568 30.784C196.048 30.88 196.496 31.008 196.912 31.168C197.36 31.296 197.744 31.456 198.064 31.648C198.384 31.808 198.624 31.984 198.784 32.176C198.208 33.584 197.568 34.976 196.864 36.352C196.16 37.728 195.504 39.088 194.896 40.432C194.288 41.744 193.776 43.056 193.36 44.368C192.944 45.68 192.736 46.96 192.736 48.208C192.736 48.88 192.784 49.472 192.88 49.984C193.008 50.464 193.136 50.88 193.264 51.232C193.392 51.552 193.504 51.824 193.6 52.048C193.728 52.272 193.792 52.464 193.792 52.624C193.792 52.656 193.76 52.704 193.696 52.768C193.664 52.8 193.632 52.816 193.6 52.816C193.376 52.816 193.088 52.768 192.736 52.672C192.384 52.576 191.984 52.432 191.536 52.24C191.12 52.08 190.688 51.888 190.24 51.664C189.824 51.44 189.424 51.2 189.04 50.944ZM199.655 48.928C199.655 47.52 199.991 45.552 200.663 43.024C201.335 40.464 202.279 37.488 203.495 34.096C205.479 28.688 207.335 24.192 209.063 20.608C210.823 16.992 212.535 14.176 214.199 12.16C214.583 12.224 215.047 12.384 215.591 12.64C216.167 12.896 216.727 13.184 217.271 13.504C217.815 13.792 218.295 14.096 218.711 14.416C219.159 14.736 219.447 14.992 219.575 15.184C217.079 18.128 214.887 21.296 212.999 24.688C211.111 28.08 209.383 31.968 207.815 36.352C206.471 40.128 205.447 43.536 204.743 46.576C204.039 49.584 203.687 52.096 203.687 54.112C203.687 54.656 203.687 54.992 203.687 55.12C203.687 55.248 203.703 55.376 203.735 55.504C203.287 55.44 202.903 55.328 202.583 55.168C202.263 55.008 202.055 54.816 201.959 54.592C201.895 54.432 201.719 54.192 201.431 53.872C201.143 53.584 200.887 53.36 200.663 53.2C200.375 53.008 200.135 52.512 199.943 51.712C199.751 50.88 199.655 49.952 199.655 48.928Z"
          fill="#1E1E1E"
        />
        <path
          d="M0.884943 73V62.8182H7.74574V64.593H3.03764V67.0192H7.39276V68.794H3.03764V71.2251H7.76562V73H0.884943ZM11.595 73.1442C11.1078 73.1442 10.6736 73.0597 10.2924 72.8906C9.91128 72.7183 9.60967 72.4647 9.38761 72.13C9.16886 71.7919 9.05948 71.371 9.05948 70.8672C9.05948 70.4429 9.13737 70.0866 9.29315 69.7983C9.44892 69.5099 9.66104 69.2779 9.92951 69.1023C10.198 68.9266 10.5029 68.794 10.8443 68.7045C11.189 68.6151 11.5502 68.5521 11.9281 68.5156C12.3722 68.4692 12.7302 68.4261 13.002 68.3864C13.2737 68.3433 13.4709 68.2803 13.5936 68.1974C13.7162 68.1146 13.7775 67.992 13.7775 67.8295V67.7997C13.7775 67.4848 13.6781 67.2412 13.4792 67.0689C13.2837 66.8965 13.0053 66.8104 12.644 66.8104C12.2628 66.8104 11.9596 66.8949 11.7342 67.0639C11.5088 67.2296 11.3597 67.4384 11.2868 67.6903L9.32795 67.5312C9.42738 67.0672 9.62293 66.6662 9.9146 66.3281C10.2063 65.9867 10.5824 65.7249 11.0431 65.5426C11.5072 65.357 12.0441 65.2642 12.6539 65.2642C13.0782 65.2642 13.4842 65.3139 13.872 65.4134C14.2631 65.5128 14.6094 65.6669 14.911 65.8757C15.216 66.0845 15.4563 66.353 15.6319 66.6811C15.8076 67.0059 15.8954 67.3954 15.8954 67.8494V73H13.8869V71.9411H13.8272C13.7046 72.1797 13.5405 72.3902 13.335 72.5724C13.1296 72.7514 12.8826 72.8923 12.5943 72.995C12.3059 73.0945 11.9728 73.1442 11.595 73.1442ZM12.2015 71.6825C12.5131 71.6825 12.7882 71.6212 13.0268 71.4986C13.2654 71.3726 13.4527 71.2036 13.5886 70.9915C13.7245 70.7794 13.7924 70.5391 13.7924 70.2706V69.4602C13.7261 69.5033 13.635 69.5431 13.519 69.5795C13.4063 69.6127 13.2787 69.6442 13.1362 69.674C12.9937 69.7005 12.8511 69.7254 12.7086 69.7486C12.5661 69.7685 12.4368 69.7867 12.3208 69.8033C12.0723 69.8397 11.8552 69.8977 11.6696 69.9773C11.484 70.0568 11.3398 70.1645 11.237 70.3004C11.1343 70.433 11.0829 70.5987 11.0829 70.7976C11.0829 71.0859 11.1873 71.3063 11.3961 71.4588C11.6083 71.608 11.8767 71.6825 12.2015 71.6825ZM17.5385 73V65.3636H19.5918V66.696H19.6713C19.8105 66.2221 20.0442 65.8641 20.3723 65.6222C20.7005 65.3769 21.0783 65.2543 21.5059 65.2543C21.6119 65.2543 21.7263 65.2609 21.8489 65.2741C21.9715 65.2874 22.0792 65.3056 22.1721 65.3288V67.2081C22.0726 67.1783 21.9351 67.1518 21.7594 67.1286C21.5837 67.1054 21.423 67.0938 21.2772 67.0938C20.9656 67.0938 20.6872 67.1617 20.4419 67.2976C20.2 67.4302 20.0078 67.6158 19.8652 67.8544C19.726 68.093 19.6564 68.3681 19.6564 68.6797V73H17.5385ZM25.3849 68.5852V73H23.267V65.3636H25.2855V66.7109H25.375C25.544 66.2668 25.8274 65.9155 26.2251 65.657C26.6229 65.3951 27.1051 65.2642 27.6719 65.2642C28.2022 65.2642 28.6645 65.3802 29.0589 65.6122C29.4534 65.8442 29.7599 66.1757 29.9787 66.6065C30.1974 67.0341 30.3068 67.5445 30.3068 68.1378V73H28.1889V68.5156C28.1922 68.0483 28.0729 67.6837 27.831 67.4219C27.589 67.1567 27.2559 67.0241 26.8317 67.0241C26.5466 67.0241 26.2947 67.0855 26.076 67.2081C25.8606 67.3307 25.6915 67.5097 25.5689 67.745C25.4496 67.977 25.3883 68.2571 25.3849 68.5852ZM39.3228 65.3636V66.9545H34.6097V65.3636H39.3228ZM35.6886 73V64.8118C35.6886 64.2583 35.7963 63.7992 36.0117 63.4347C36.2305 63.0701 36.5288 62.7966 36.9066 62.6143C37.2844 62.4321 37.7137 62.3409 38.1942 62.3409C38.5191 62.3409 38.8157 62.3658 39.0842 62.4155C39.3559 62.4652 39.5581 62.5099 39.6907 62.5497L39.3129 64.1406C39.23 64.1141 39.1272 64.0893 39.0046 64.0661C38.8853 64.0429 38.7627 64.0312 38.6367 64.0312C38.3252 64.0312 38.1081 64.1042 37.9854 64.25C37.8628 64.3925 37.8015 64.593 37.8015 64.8516V73H35.6886ZM40.6167 73V65.3636H42.6699V66.696H42.7495C42.8887 66.2221 43.1223 65.8641 43.4505 65.6222C43.7786 65.3769 44.1564 65.2543 44.584 65.2543C44.69 65.2543 44.8044 65.2609 44.927 65.2741C45.0497 65.2874 45.1574 65.3056 45.2502 65.3288V67.2081C45.1507 67.1783 45.0132 67.1518 44.8375 67.1286C44.6619 67.1054 44.5011 67.0938 44.3553 67.0938C44.0437 67.0938 43.7653 67.1617 43.5201 67.2976C43.2781 67.4302 43.0859 67.6158 42.9434 67.8544C42.8042 68.093 42.7346 68.3681 42.7346 68.6797V73H40.6167ZM49.44 73.1491C48.6677 73.1491 47.9999 72.9851 47.4364 72.657C46.8763 72.3255 46.4438 71.8648 46.1388 71.2749C45.8339 70.6816 45.6815 69.9938 45.6815 69.2116C45.6815 68.4228 45.8339 67.7334 46.1388 67.1435C46.4438 66.5502 46.8763 66.0895 47.4364 65.7614C47.9999 65.4299 48.6677 65.2642 49.44 65.2642C50.2122 65.2642 50.8784 65.4299 51.4386 65.7614C52.002 66.0895 52.4362 66.5502 52.7411 67.1435C53.046 67.7334 53.1985 68.4228 53.1985 69.2116C53.1985 69.9938 53.046 70.6816 52.7411 71.2749C52.4362 71.8648 52.002 72.3255 51.4386 72.657C50.8784 72.9851 50.2122 73.1491 49.44 73.1491ZM49.4499 71.5085C49.8013 71.5085 50.0946 71.4091 50.3299 71.2102C50.5652 71.008 50.7425 70.733 50.8619 70.3849C50.9845 70.0369 51.0458 69.6409 51.0458 69.1967C51.0458 68.7526 50.9845 68.3565 50.8619 68.0085C50.7425 67.6605 50.5652 67.3854 50.3299 67.1832C50.0946 66.9811 49.8013 66.88 49.4499 66.88C49.0953 66.88 48.797 66.9811 48.555 67.1832C48.3164 67.3854 48.1358 67.6605 48.0131 68.0085C47.8938 68.3565 47.8342 68.7526 47.8342 69.1967C47.8342 69.6409 47.8938 70.0369 48.0131 70.3849C48.1358 70.733 48.3164 71.008 48.555 71.2102C48.797 71.4091 49.0953 71.5085 49.4499 71.5085ZM54.5756 73V65.3636H56.5941V66.7109H56.6836C56.8427 66.2635 57.1078 65.9105 57.479 65.652C57.8503 65.3935 58.2944 65.2642 58.8114 65.2642C59.3351 65.2642 59.7809 65.3951 60.1488 65.657C60.5167 65.9155 60.762 66.2668 60.8846 66.7109H60.9641C61.1199 66.2734 61.4016 65.9238 61.8093 65.6619C62.2203 65.3968 62.7058 65.2642 63.266 65.2642C63.9786 65.2642 64.5569 65.4912 65.0011 65.9453C65.4485 66.3961 65.6722 67.0357 65.6722 67.8643V73H63.5593V68.282C63.5593 67.8577 63.4466 67.5395 63.2212 67.3274C62.9959 67.1153 62.7141 67.0092 62.3761 67.0092C61.9916 67.0092 61.6916 67.1319 61.4762 67.3771C61.2608 67.6191 61.1531 67.9389 61.1531 68.3366V73H59.0998V68.2372C59.0998 67.8627 58.9921 67.5644 58.7766 67.3423C58.5645 67.1203 58.2844 67.0092 57.9364 67.0092C57.7011 67.0092 57.489 67.0689 57.3001 67.1882C57.1145 67.3042 56.967 67.4683 56.8576 67.6804C56.7482 67.8892 56.6935 68.1345 56.6935 68.4162V73H54.5756ZM71.8929 75.8636C71.6245 75.8636 71.3726 75.8421 71.1373 75.799C70.9052 75.7592 70.713 75.7079 70.5605 75.6449L71.0378 74.0639C71.2864 74.1402 71.5101 74.1816 71.709 74.1882C71.9112 74.1948 72.0852 74.1484 72.231 74.049C72.3801 73.9496 72.5011 73.7805 72.5939 73.5419L72.7182 73.2188L69.9789 65.3636H72.2061L73.7871 70.9716H73.8667L75.4625 65.3636H77.7047L74.7367 73.8253C74.5942 74.2363 74.4003 74.5942 74.155 74.8991C73.9131 75.2074 73.6065 75.4444 73.2353 75.6101C72.8641 75.7791 72.4166 75.8636 71.8929 75.8636ZM81.9927 73.1491C81.2205 73.1491 80.5526 72.9851 79.9892 72.657C79.429 72.3255 78.9965 71.8648 78.6916 71.2749C78.3867 70.6816 78.2342 69.9938 78.2342 69.2116C78.2342 68.4228 78.3867 67.7334 78.6916 67.1435C78.9965 66.5502 79.429 66.0895 79.9892 65.7614C80.5526 65.4299 81.2205 65.2642 81.9927 65.2642C82.765 65.2642 83.4312 65.4299 83.9913 65.7614C84.5547 66.0895 84.9889 66.5502 85.2939 67.1435C85.5988 67.7334 85.7512 68.4228 85.7512 69.2116C85.7512 69.9938 85.5988 70.6816 85.2939 71.2749C84.9889 71.8648 84.5547 72.3255 83.9913 72.657C83.4312 72.9851 82.765 73.1491 81.9927 73.1491ZM82.0027 71.5085C82.354 71.5085 82.6473 71.4091 82.8826 71.2102C83.118 71.008 83.2953 70.733 83.4146 70.3849C83.5372 70.0369 83.5985 69.6409 83.5985 69.1967C83.5985 68.7526 83.5372 68.3565 83.4146 68.0085C83.2953 67.6605 83.118 67.3854 82.8826 67.1832C82.6473 66.9811 82.354 66.88 82.0027 66.88C81.648 66.88 81.3497 66.9811 81.1078 67.1832C80.8691 67.3854 80.6885 67.6605 80.5659 68.0085C80.4466 68.3565 80.3869 68.7526 80.3869 69.1967C80.3869 69.6409 80.4466 70.0369 80.5659 70.3849C80.6885 70.733 80.8691 71.008 81.1078 71.2102C81.3497 71.4091 81.648 71.5085 82.0027 71.5085ZM92.0254 69.7486V65.3636H94.1433V73H92.1099V71.6129H92.0304C91.858 72.0604 91.5713 72.42 91.1703 72.6918C90.7725 72.9635 90.287 73.0994 89.7136 73.0994C89.2032 73.0994 88.7541 72.9834 88.3663 72.7514C87.9785 72.5194 87.6752 72.1896 87.4565 71.7621C87.2411 71.3345 87.1317 70.8224 87.1284 70.2259V65.3636H89.2463V69.848C89.2496 70.2988 89.3706 70.6551 89.6092 70.9169C89.8478 71.1787 90.1677 71.3097 90.5687 71.3097C90.8239 71.3097 91.0626 71.2517 91.2846 71.1357C91.5067 71.0163 91.6857 70.8407 91.8216 70.6087C91.9608 70.3767 92.0287 70.09 92.0254 69.7486ZM95.8374 73V65.3636H97.8906V66.696H97.9702C98.1094 66.2221 98.343 65.8641 98.6712 65.6222C98.9993 65.3769 99.3771 65.2543 99.8047 65.2543C99.9107 65.2543 100.025 65.2609 100.148 65.2741C100.27 65.2874 100.378 65.3056 100.471 65.3288V67.2081C100.371 67.1783 100.234 67.1518 100.058 67.1286C99.8826 67.1054 99.7218 67.0938 99.576 67.0938C99.2644 67.0938 98.986 67.1617 98.7408 67.2976C98.4988 67.4302 98.3066 67.6158 98.1641 67.8544C98.0249 68.093 97.9553 68.3681 97.9553 68.6797V73H95.8374ZM108.256 73.1491C107.474 73.1491 106.801 72.9834 106.238 72.652C105.678 72.3172 105.247 71.8532 104.945 71.2599C104.647 70.6667 104.498 69.9839 104.498 69.2116C104.498 68.4295 104.649 67.7434 104.95 67.1534C105.255 66.5601 105.688 66.0978 106.248 65.7663C106.808 65.4316 107.474 65.2642 108.246 65.2642C108.913 65.2642 109.496 65.3852 109.996 65.6271C110.497 65.8691 110.893 66.2088 111.185 66.6463C111.476 67.0838 111.637 67.5975 111.667 68.1875H109.668C109.612 67.8063 109.463 67.4998 109.221 67.2678C108.982 67.0324 108.669 66.9148 108.281 66.9148C107.953 66.9148 107.666 67.0043 107.421 67.1832C107.179 67.3589 106.99 67.6158 106.854 67.9538C106.719 68.2919 106.651 68.7012 106.651 69.1818C106.651 69.669 106.717 70.0833 106.849 70.4247C106.985 70.7661 107.176 71.0263 107.421 71.2053C107.666 71.3842 107.953 71.4737 108.281 71.4737C108.523 71.4737 108.74 71.424 108.933 71.3246C109.128 71.2251 109.289 71.081 109.415 70.892C109.544 70.6998 109.629 70.4695 109.668 70.201H111.667C111.634 70.7843 111.475 71.2981 111.19 71.7422C110.908 72.183 110.518 72.5277 110.021 72.7763C109.524 73.0249 108.936 73.1491 108.256 73.1491ZM116.473 73.1491C115.701 73.1491 115.033 72.9851 114.47 72.657C113.91 72.3255 113.477 71.8648 113.172 71.2749C112.867 70.6816 112.715 69.9938 112.715 69.2116C112.715 68.4228 112.867 67.7334 113.172 67.1435C113.477 66.5502 113.91 66.0895 114.47 65.7614C115.033 65.4299 115.701 65.2642 116.473 65.2642C117.245 65.2642 117.912 65.4299 118.472 65.7614C119.035 66.0895 119.469 66.5502 119.774 67.1435C120.079 67.7334 120.232 68.4228 120.232 69.2116C120.232 69.9938 120.079 70.6816 119.774 71.2749C119.469 71.8648 119.035 72.3255 118.472 72.657C117.912 72.9851 117.245 73.1491 116.473 73.1491ZM116.483 71.5085C116.834 71.5085 117.128 71.4091 117.363 71.2102C117.598 71.008 117.776 70.733 117.895 70.3849C118.018 70.0369 118.079 69.6409 118.079 69.1967C118.079 68.7526 118.018 68.3565 117.895 68.0085C117.776 67.6605 117.598 67.3854 117.363 67.1832C117.128 66.9811 116.834 66.88 116.483 66.88C116.128 66.88 115.83 66.9811 115.588 67.1832C115.35 67.3854 115.169 67.6605 115.046 68.0085C114.927 68.3565 114.867 68.7526 114.867 69.1967C114.867 69.6409 114.927 70.0369 115.046 70.3849C115.169 70.733 115.35 71.008 115.588 71.2102C115.83 71.4091 116.128 71.5085 116.483 71.5085ZM123.727 68.5852V73H121.609V65.3636H123.627V66.7109H123.717C123.886 66.2668 124.169 65.9155 124.567 65.657C124.965 65.3951 125.447 65.2642 126.014 65.2642C126.544 65.2642 127.006 65.3802 127.401 65.6122C127.795 65.8442 128.102 66.1757 128.32 66.6065C128.539 67.0341 128.649 67.5445 128.649 68.1378V73H126.531V68.5156C126.534 68.0483 126.415 67.6837 126.173 67.4219C125.931 67.1567 125.598 67.0241 125.173 67.0241C124.888 67.0241 124.637 67.0855 124.418 67.2081C124.202 67.3307 124.033 67.5097 123.911 67.745C123.791 67.977 123.73 68.2571 123.727 68.5852ZM134.38 65.3636V66.9545H129.781V65.3636H134.38ZM130.825 63.5341H132.943V70.6534C132.943 70.849 132.973 71.0014 133.032 71.1108C133.092 71.2169 133.175 71.2914 133.281 71.3345C133.39 71.3776 133.516 71.3991 133.659 71.3991C133.758 71.3991 133.858 71.3909 133.957 71.3743C134.056 71.3544 134.133 71.3395 134.186 71.3295L134.519 72.9055C134.413 72.9387 134.264 72.9768 134.071 73.0199C133.879 73.0663 133.645 73.0945 133.37 73.1044C132.86 73.1243 132.413 73.0563 132.028 72.9006C131.647 72.7448 131.35 72.5028 131.138 72.1747C130.926 71.8466 130.822 71.4323 130.825 70.9318V63.5341ZM139.157 73.1491C138.372 73.1491 137.696 72.9901 137.129 72.6719C136.565 72.3504 136.131 71.8963 135.826 71.3097C135.521 70.7197 135.369 70.022 135.369 69.2166C135.369 68.4311 135.521 67.7417 135.826 67.1484C136.131 66.5552 136.56 66.0928 137.114 65.7614C137.671 65.4299 138.324 65.2642 139.073 65.2642C139.577 65.2642 140.046 65.3454 140.48 65.5078C140.917 65.6669 141.298 65.9072 141.623 66.2287C141.951 66.5502 142.207 66.9545 142.389 67.4418C142.571 67.9257 142.662 68.4924 142.662 69.142V69.7237H136.214V68.4112H140.669C140.669 68.1063 140.602 67.8362 140.47 67.6009C140.337 67.3655 140.153 67.1816 139.918 67.049C139.686 66.9131 139.416 66.8452 139.108 66.8452C138.786 66.8452 138.501 66.9197 138.252 67.0689C138.007 67.2147 137.815 67.4119 137.676 67.6605C137.537 67.9058 137.465 68.1792 137.462 68.4808V69.7287C137.462 70.1065 137.532 70.433 137.671 70.7081C137.813 70.9832 138.014 71.1953 138.272 71.3445C138.531 71.4936 138.837 71.5682 139.192 71.5682C139.427 71.5682 139.643 71.535 139.838 71.4688C140.034 71.4025 140.201 71.303 140.341 71.1705C140.48 71.0379 140.586 70.8755 140.659 70.6832L142.618 70.8125C142.518 71.2831 142.314 71.6941 142.006 72.0455C141.701 72.3935 141.307 72.6652 140.823 72.8608C140.342 73.053 139.787 73.1491 139.157 73.1491ZM146.162 68.5852V73H144.044V65.3636H146.063V66.7109H146.152C146.321 66.2668 146.605 65.9155 147.002 65.657C147.4 65.3951 147.882 65.2642 148.449 65.2642C148.98 65.2642 149.442 65.3802 149.836 65.6122C150.231 65.8442 150.537 66.1757 150.756 66.6065C150.975 67.0341 151.084 67.5445 151.084 68.1378V73H148.966V68.5156C148.97 68.0483 148.85 67.6837 148.608 67.4219C148.366 67.1567 148.033 67.0241 147.609 67.0241C147.324 67.0241 147.072 67.0855 146.853 67.2081C146.638 67.3307 146.469 67.5097 146.346 67.745C146.227 67.977 146.166 68.2571 146.162 68.5852ZM156.815 65.3636V66.9545H152.216V65.3636H156.815ZM153.26 63.5341H155.378V70.6534C155.378 70.849 155.408 71.0014 155.468 71.1108C155.528 71.2169 155.61 71.2914 155.716 71.3345C155.826 71.3776 155.952 71.3991 156.094 71.3991C156.194 71.3991 156.293 71.3909 156.393 71.3743C156.492 71.3544 156.568 71.3395 156.621 71.3295L156.954 72.9055C156.848 72.9387 156.699 72.9768 156.507 73.0199C156.315 73.0663 156.081 73.0945 155.806 73.1044C155.296 73.1243 154.848 73.0563 154.464 72.9006C154.082 72.7448 153.786 72.5028 153.574 72.1747C153.362 71.8466 153.257 71.4323 153.26 70.9318V63.5341Z"
          fill="#585858"
        />
      </svg>

      <hgroup>
        <h1>Review and earn!</h1>
        <p>Unlock Exciting Deals with Your Honest Reviews</p>
      </hgroup>
      <p>
        At ReviewDeals, we believe in rewarding your opinions. Get access to
        exclusive discounts, offers, and freebies simply by sharing your
        thoughts on products and services you love.
      </p>
    </section>

    <section class="sticky">
      <base-form
        :disabled="selectedGeoResultId.length === 0"
        :show-submit-button="false"
      >
        <dropdown-select
          :ariaBusy="isLoadingGeoResults"
          @update:modelValue="selectResult"
          :modelValue="selectedGeoResultId"
          :options="optionsToShowWithSelected"
          v-model:search="geoSearchTerm"
          @update:search="debounceGetGeolocationData($event)"
          searchable
          autofocus
          required
          v-model:isOpen="isOpen"
          :searchLocally="false"
          :placeholder="`Where to?`"
          style="margin-bottom: 0"
          :search-placeholder="`Search for a neighborhood, city or state`"
        >
          <template #optionSlot="{ option, updateModelValue }">
            <label>
              <input
                type="checkbox"
                :value="option.id"
                :checked="selectedGeoResultId.includes(option.id)"
                @click="updateModelValue"
              />
              <span>{{ option.render }}</span>
              <small> - {{ option.raw.addresstype }}</small>
            </label>
          </template>
        </dropdown-select>
      </base-form>
      <tab-nav
        v-if="selectedGeoResult?.place_id"
        v-model="selectedCategory"
        :options="categoriesToShow"
        @click="
          resetCurrentPage();
          scrollUp();
        "
      >
      </tab-nav>
    </section>

    <section v-if="selectedGeoResult?.place_id">
      <card-element v-if="showLoadingMessage">
        <b>Still gathering all offers...</b>
        <p>Hold tight, it's almost done</p>
      </card-element>
      <card-element
        v-else-if="isLoadingOverpassResults && usableResults.length === 0"
        :loading="true"
      >
        Loading...
      </card-element>
      <card-element v-else>
        <b
          ><ins>Earn up to {{ totalEarnable }} on this trip</ins></b
        >
        <p>In exchange for your honest reviews</p>
      </card-element>
      <template v-if="isLoadingOverpassResults">
        <!-- 15 random card-elements -->
        <card-element
          v-for="i in 15"
          :key="i"
          :loading="true"
          title="Loading"
          subtitle="Loading"
          :images="[{ src: 'https://via.placeholder.com/150', alt: 'Loading' }]"
        >
          Loading...
        </card-element>
      </template>
      <template v-else>
        <base-modal
          v-for="item in filteredOverpassResults"
          :key="item.id"
          :title="
            randomFood(Object.keys(item.tags).length) + ' at ' + item.tags?.name
          "
        >
          <p>Upload requirements</p>
          <p>
            If you meet all the requirements below, submit your content to get
            “{{
              randomFood(Object.keys(item.tags).length) +
              " at " +
              item.tags?.name
            }}”
          </p>
          <ul>
            <li>Upload a photo of the coffee and bagel</li>
            <li>Write a review of the coffee and bagel</li>
            <li>Upload a photo of the coffee and bagel</li>
            <li>Write a review of the coffee and bagel</li>
            <li>Upload a photo of the coffee and bagel</li>
            <li>Write a review of the coffee and bagel</li>
            <li>Upload a photo of the coffee and bagel</li>
          </ul>
          <input type="file" />
          <template #trigger="{ openModal }">
            <card-element
              :title="
                randomFood(Object.keys(item.tags).length) +
                ' at ' +
                item.tags?.name
              "
              :subtitle="`In exchange for a review of the ${item.tags?.amenity}`"
              :images="[
                {
                  src: 'https://picsum.photos/200?random=' + item.id,
                  alt: item.tags?.name,
                },
              ]"
              @click="openModal"
            >
              <p>{{ item.tags?.description ?? item.tags?.opening_hours }}</p>
              <template #headerActions
                ><ins>+ €{{ Object.keys(item.tags).length }}</ins></template
              >
              <template #footer>
                <p>{{ item.tags?.cuisine }}</p>
              </template>
            </card-element>
          </template>
        </base-modal>
      </template>
      <pagination-nav
        v-model:current-page="currentResultsPage"
        :total-items="usableResults.length"
        :results-per-page="15"
        @click="scrollUp"
      />
    </section>
    <section v-else>
      <h2>How it works</h2>
      <ol>
        <li>
          <strong>Discover Deals:</strong> Browse through our curated selection
          of products and services from top brands.
        </li>
        <li>
          <strong>Write Reviews:</strong> Share your honest feedback on the
          items you've tried.
        </li>
        <li>
          <strong>Get Rewarded:</strong> Receive exclusive discounts and offers
          based on your reviews.
        </li>
      </ol>
      <h2>Why Choose ReviewDeals?</h2>
      <ul>
        <li>
          <strong>Save Money:</strong> Enjoy discounts and offers on products
          you already love or want to try.
        </li>
        <li>
          <strong>Make Your Voice Heard:</strong> Your feedback helps brands
          improve their products and services.
        </li>
        <li>
          <strong>Exclusive Access:</strong> Get access to deals not available
          elsewhere.
        </li>
      </ul>
      <h2>Join the Community</h2>
      <p>
        Sign up today and become part of a community that values your opinions.
        Start unlocking exclusive deals and sharing your feedback with
        ReviewDeals!
      </p>
    </section>
  </main>
</template>
